DIM U(97,65)
DISP "» GRIDS";
INPUT N
DISP "» X POINTS, INCL. BOUNDARY POINTS";
INPUT II
DISP "» Y POINTS, INCL. BOUNDARY POINTS";
INFUT Jl
DISP "H";
INPUT H
DISP "» RELAXATIONS";
INPUT N0
DISP "» CYCLES";
INPUT Cl
print "» GPIDS=";N;" #x points«";I1;" #Y POINTS-";J1;" H = ";H
PRINT "» RELAXATIONS=";NO;" # CYCLES";C1
C=0
FOR 1=1 TO II
FOR J=l TO Jl
U<I, J)=C0S<3*<I+J-2)*H)
NEXT J
NEXT I
C=C+1
FOR K-l. TO H
M1=2"<N-K)
FOR H8=l TO N0
E=e
FOR I=1+M1 TO I 1-Ml STEP Ml
FOR J=1+M1 TO Jl-Ml STEP Ml
At=0
R1=0
FOR I3=I-MI+1 TO I+Ml-1
FOR J3=J-M1+1 TO J+Ml-1
D=4+EXPÍ(I3+J3-2>«H+H*H
R«D*U<I3,J3)-U<I3,J3-1)-U<I3,J3+1)-U<I3-1,J3)-U<I3+1,J3)
R=R-SINk3»<I3+J3-2)*H)*H*H
A3 = D*FND(I3,J3)-FND(I3,J3+1)-FHD<13.J3-1 >-FND<I3+l,J3>-FND<13-1, 13)
R1=R1+FHD<I3,J3)*R
A1=A1+FND(I3,J3)«A3
NEXT J3
NEXT 13
S=R1'A1
E=E+R1*R1
FOR 13=1-111 + 1 TO I+Ml-1
FOR J3=J-M1+1 TO J+Ml-1
U<13,J3)=U<I3,J3)-S*FND<I3,J3)
NEXT J3
NEXT 13
NEXT J
NEXT I
E=SQR(E)/M1/H
PRINT "LEVEL = ";N-K+l; " ERPOP=";E
NEXT N8
NEXT K
IF C<C1 THEN 220
DEF FND(I3, J3)=(M1-ABS(I-I3))*i M1 -ABS>: J- J3 > > .Ml «Ml >
END
